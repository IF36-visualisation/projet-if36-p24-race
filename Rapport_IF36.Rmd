---
title: "Rapport IF36 - 120 years of olympic history"
subtitle: "Semestre : P24"
author: "Mohamed Amine jabote / Thomas Francois / Freddy Durel Pouna Wantou"
date: "2024-04-25"
output: 
  html_document:
    runtime: shiny
    viewport: width=device-width, initial-scale=1
---

```{r setup, include=FALSE}

library(dplyr)
library(ggplot2)
library(readr)
library(plotly)
library(tidyr)

```

```{r loading data, include=FALSE}
data_jo = read_csv('athlete_events.csv')
data_noc_regions <- read_csv('noc_regions.csv')
```

</br>

<p align="center">

<img src="https://st.depositphotos.com/2793427/4712/i/450/depositphotos_47122635-stock-photo-white-olympics-flag-against-the.jpg" width="80%"/>

</p>

</br>

# Introduction

Le jeu de données **"120 ans de l'histoire des Jeux Olympiques"** contient les données de 28 éditions d'été et 22 d'hiver des Jeux Olympiques, ce qui équivaut à un peu moins de 136 000 individus, répartis sur 15 variables. Ces variables comprennent des informations telles que le nom de l'athlète, son âge, son poids, sa taille, son sexe, la saison des Jeux Olympiques, les médailles remportées, etc. Les données proviennent du site www.sports-reference.com et elles sont le résultat d'un travail de recherche réalisé par un groupe intéressé par l'histoire des jeux olympiques. Le site propose une base de données complète avec des informations diverses et variées sur les médailles gagnées par chaque pays, les résultats des compétitions, et bien plus encore.

Nous avons sélectionné un ensemble de données sur les Jeux olympiques en raison de l'engouement actuel en France pour cet événement, en particulier avec les Jeux olympiques de **Paris 2024** à l'horizon. Les Jeux olympiques représentent une célébration mondiale de l'excellence sportive et de la diversité culturelle, et ils captivent l'attention de millions de personnes à travers le monde. Avec des membres de notre groupe ayant des niveaux de connaissances variés sur les Jeux olympiques, l'étude de ce dataset nous offre l'opportunité unique de plonger dans l'histoire et les tendances de cet événement emblématique, tout en élargissant notre compréhension de l'impact du sport sur la société à travers les âges.

Le jeu de données est disponible sur [Cette page Kaggle](https://www.kaggle.com/datasets/heesoo37/120-years-of-olympic-history-athletes-and-results?select=athlete_events.csv) et a été publié par [**Randi H Griffin**](https://www.linkedin.com/in/randigriffin/), une Lead Data Scientist chez **BCG**, dans le but de découvrir l'évolution des Jeux Olympiques ainsi que la participation et les performances des athlètes et des pays. Les données sont fournies au format **CSV**.

</br>

## Données

Le tableau ci-dessous présente les **15 attributs** du jeu de données sur lequel nous allons travailler. Ces données sont extraites d'un ensemble de données concernant les performances des athlètes aux Jeux olympiques.

Chaque attribut offre des informations précieuses sur les athlètes, les événements sportifs et les médailles remportées. Ces données sont pertinentes pour notre projet car elles nous permettront d'analyser les performances des athlètes dans différents sports et événements, d'étudier les tendances au fil des éditions des Jeux olympiques et d'identifier les caractéristiques des médaillés olympiques.

Certaines variables, telles que **le sexe de l'athlète**,**la saison des Jeux olympiques (été ou hiver)** et **la nationalité de l'équipe de l'athlète**, présentent des catégories ou des sous-groupes au sein des données, ce qui nous permettra d'effectuer des analyses plus détaillées en fonction de ces caractéristiques.

Le tableau ci-dessous offre une description détaillée de chaque attribut, y compris son nom, sa signification et son type de données. Ces informations serviront de référence tout au long de notre projet.

<br>

::: {width="100%" align="center"}
| Attribut   | Description                                                                   | Type      | Format  | Catégorie |
|-------------|-----------------------|-------------|-------------|-------------|
| **ID**     | Identifiant unique de l'athlète                                               | Texte     | String  | Nominal   |
| **Name**   | Nom de l'athlète                                                              | Texte     | String  | Nominal   |
| **Sexe**   | Sexe de l'athlète ***(homme ou femme)***                                      | Texte     | String  | Nominal   |
| **Age**    | Âge de l'athlète lors des Jeux olympiques                                     | Numérique | Integer | Continu   |
| **Height** | Taille de l'athlète en centimètres                                            | Numérique | Integer | Continu   |
| **Weight** | Poids de l'athlète en kilogrammes                                             | Numérique | Float   | Continu   |
| **Team**   | Nationalité de l'équipe de l'athlète                                          | Texte     | String  | String    |
| **NOC**    | Abréviation du Comité national olympique de l'équipe                          | Texte     | String  | Nominal   |
| **Games**  | Nom de l'édition des Jeux olympiques                                          | Texte     | String  | Nominal   |
| **Year**   | Année de l'édition des Jeux olympiques                                        | Texte     | YYYY    | Discret   |
| **Season** | Saison des Jeux olympiques ***(été ou hiver)***                               | Texte     | String  | Ordinal   |
| **City**   | Ville hôte des Jeux olympiques                                                | Texte     | String  | Nominal   |
| **Sport**  | Sport pratiqué par l'athlète                                                  | Texte     | String  | Nominal   |
| **Event**  | Événement sportif dans lequel l'athlète a participé                           | Texte     | String  | Nominal   |
| **Medal**  | Type de médaille remportée par l'athlète ***(or, argent, bronze ou aucune)*** | Texte     | String  | Ordinal   |
:::

</br>

## Plan d'analyse

Nous avons compilé une série de questions que nous tenterons de résoudre en utilisant le jeu de données. Pour chaques question, nous avons une liste d'examples de visualisations possibles. Ces questions sont divisées en deux catégories principales : l'évolution des Jeux Olympiques et les performances des athlètes.

#### L'évolution des Jeux Olympiques

## 1. Quels pays ont exercé une domination dans l'histoire des Jeux Olympiques ?

Dans cette analyse, nous chercherons à identifier les pays qui ont accumulé le plus grand nombre de médailles dans l'histoire des Jeux Olympiques, qu'elles soient en or, argent ou bronze, ainsi que le total de ces médailles. De plus, nous déterminerons pour chaque discipline quel pays a remporté le plus de médailles.

-   **Graphique à barres des meilleurs pays par médailles :** Pour comparer directement les performances des pays les plus réussis. Il permet une comparaison claire et rapide des totaux de médailles entre les principaux pays, ce qui est utile pour identifier les leaders incontestés et les écarts significatifs entre eux.

-   **Diagramme circulaire ou camembert des médailles par type :** Pour illustrer la répartition des médailles par type pour chaque pays. Il offre une vue d'ensemble instantanée des performances relatives en or, argent et bronze, permettant de déterminer si un pays a une domination particulière dans une catégorie de médailles.

-   **Courbe présentant l'évolution du nombre total de médailles sur les 150 dernières années pour les pays dominants :** permet d'identifier les périodes de domination ou de déclin, ainsi que les évolutions à long terme des performances olympiques des pays.

## 2. Comment les Jeux Olympiques d'été se différencient-ils aux Jeux Olympiques d'hiver ?

Cette question examine comment les Jeux Olympiques d'été se différencient des Jeux Olympiques d'hiver en termes de sports pratiqués, de nombre d'épreuves, de participants, et d'autres aspects. Elle met en évidence les distinctions entre les deux versions du même événement.

-   **Graphique en barres du nombre d'épreuves :** Graphique en barres comparant le nombre total d'épreuves aux Jeux Olympiques d'été et d'hiver au fil du temps. Cela permet de visualiser les variations dans la taille et la complexité des deux événements au fil des ans.

-   **Diagramme circulaire des participants :** Un diagramme circulaire montrant la répartition des participants par région ou pays aux Jeux Olympiques d'été et d'hiver. Cela permet de comparer la diversité géographique des participants entre les deux événements.

-   **Graphique en barres empilées des médailles par pays :** Un graphique en barres empilées comparant les médailles remportées par chaque pays aux Jeux Olympiques d'été et d'hiver. Cette visualisation met en évidence les performances des pays dans les deux types de jeux et permet de déterminer s'il existe des différences significatives dans les pays dominant chaque événement.

## 3. Comment varie le nombre d'épreuves sportives et le nombre d'athlètes participant aux Jeux Olympiques au fil du temps ?

L'objectif ici est de déterminer quels sont les sports qui ont été intégrés au cours des années et à quel moment ceux-ci se sont intégrés. Ceci aussi a pour visée de déterminer la raison de l'ajout de ces disciplines (popularité grandissante ou juste nouveau sport). Dans un second temps, il s'agira d'identifier ou non l'entrée en liste de nouveaux pays participants dans les jeux. D'en déterminer les origines (première qualification ou alors accueil de nouveaux pays admissibles). Enfin, il s'agit de déterminer comment évolue le nombre d'athlètes participant aux jeux au fil des années.

-   **Graphique en ligne du nombre d'athlètes par année :** Un graphique en ligne représentant l'évolution du nombre total d'athlètes participant aux Jeux Olympiques au fil des ans. Cette visualisation mettrait en évidence les variations dans la taille de la délégation olympique mondiale au fil du temps.

-   **Graphique en barres du nombre d'épreuves par discipline sportive :** Un graphique en barres montrant le nombre d'épreuves par discipline sportive (par exemple, course, lancer, saut pour l'athlétisme) aux Jeux Olympiques au fil du temps. Cela offre une vue détaillée des changements dans la composition et la diversité des épreuves sportives au fil des ans.

## 4. Est-ce que le pays hôte des Jeux Olympiques bénéficie d'un avantage par rapport aux autres nations participantes ?

Cette question vise à déterminer si le pays hôte des Jeux Olympiques bénéficie d'un avantage en termes de participation et de performances sportives, telles que le nombre de médailles accumulées, par rapport aux autres nations participantes. L'objectif est d'analyser si le fait d'accueillir les Jeux Olympiques donne un élan supplémentaire aux athlètes du pays hôte, leur permettant de performer au-dessus de la moyenne par rapport à leurs performances habituelles.

-   **Graphique en barres du nombre de médailles par pays :** Un graphique en barres comparant le nombre total de médailles remportées par le pays hôte par rapport aux autres nations participantes. Cela permettrait de voir visuellement si le pays hôte obtient plus de médailles que la moyenne des autres pays.

-   **Graphique en barres empilées des médailles par type pour le pays hôte et les autres nations :** Un graphique en barres empilées montrant la répartition des médailles d'or, d'argent et de bronze remportées par le pays hôte et les autres nations participantes. Cette visualisation permettrait de comparer les performances dans chaque catégorie de médailles.

-   **Nuage de points des performances par rapport à la moyenne :** Un nuage de points avec le pays hôte et les autres nations sur l'axe des x et le nombre total de médailles sur l'axe des y. Chaque point représenterait une édition des Jeux Olympiques, et sa position par rapport à une ligne moyenne permettrait de visualiser si le pays hôte surperforme ou sous-performe par rapport à la moyenne des autres nations.

## 5. Existe-t-il une relation entre le niveau économique d'un pays et ses performances aux Jeux Olympiques ?

Il est intéressant d'explorer si le niveau économique d'un pays, mesuré par le PIB par habitant, influence ses performances aux Jeux Olympiques. Cette analyse nous aide à voir comment l'argent et les ressources affectent les succès sportifs à travers les nations.

-   **Nuage de points du PIB par habitant par rapport au nombre de médailles :** Un nuage de points avec le PIB par habitant sur l'axe des x et le nombre total de médailles remportées sur l'axe des y pour chaque pays participant aux Jeux Olympiques. Chaque point représente un pays pour une année donnée, permettant de visualiser s'il existe une corrélation entre la richesse économique d'un pays et son succès aux Jeux Olympiques.

-   **Graphique en ligne de l'évolution du PIB par habitant et du nombre de médailles :** Un graphique en ligne avec le PIB par habitant et le nombre total de médailles remportées pour chaque année olympique. Cette visualisation permettrait d'observer comment l'évolution du niveau économique d'un pays au fil du temps est liée à ses performances aux Jeux Olympiques.

### Les athlètes

## 6. Quels sont les athlètes qui ont marqué les jeux olympiques ?

Cette question cherche à identifier les athlètes qui ont marqué les Jeux Olympiques par leurs performances exceptionnelles. L'objectif est d'analyser les données historiques des Jeux Olympiques pour identifier les athlètes les plus médaillés, les records établis et les moments marquants de l'histoire des Jeux.

-   **Graphique en barres des athlètes les plus médaillés :** n graphique en barres montrant les athlètes ayant remporté le plus grand nombre de médailles olympiques, classés par discipline sportive ou nombre total de médailles. Cette visualisation permettrait d'identifier les athlètes les plus titrés de l'histoire des Jeux Olympiques.

-   **Graphique en nuage de points des records battus au fil du temps :** Un graphique en nuage de points représentant les records olympiques battus au fil des éditions des Jeux Olympiques. Chaque point représenterait un record battu dans une discipline sportive spécifique, avec l'année sur l'axe des x et la performance réalisée sur l'axe des y. Cette visualisation permettrait de visualiser les tendances et les progrès réalisés dans différentes disciplines au fil du temps.

## 7. Quels sont les impacts des caractéristiques physiques sur les résultats ?

Cette question vise à explorer les impacts des caractéristiques physiques des athlètes sur leurs performances aux Jeux Olympiques. L'objectif est d'analyser comment des facteurs tels que la taille, le poids, l'âge et d'autres caractéristiques physiques peuvent influencer les résultats sportifs.

-   **Graphique en nuage de points de la taille et du poids des médaillés :** Un graphique en nuage de points représentant la relation entre la taille et le poids des athlètes médaillés dans différentes disciplines sportives. Cela permettrait d'identifier s'il existe des tendances générales entre les caractéristiques physiques des athlètes et leurs performances.

-   **Graphique en barres des médailles par tranche d'âge :** Un graphique en barres montrant la répartition des médailles par tranche d'âge des athlètes. Cela permettrait d'analyser si les performances sportives varient en fonction de l'âge des athlètes et s'il existe des différences significatives entre les groupes d'âge.

-   **Analyse de corrélation entre les caractéristiques physiques et les performances (Nuage) :** Une analyse statistique explorant les corrélations entre les caractéristiques physiques telles que la taille, le poids, l'âge, etc., et les performances sportives des athlètes. Cette analyse pourrait mettre en évidence les facteurs physiques qui ont le plus d'impact sur les résultats sportifs aux Jeux Olympiques.

## 8. Est-ce que la répartition des médailles entre hommes et femmes varie selon les pays ?

Cette question vise à examiner si la répartition des médailles entre hommes et femmes varie d'un pays à l'autre aux Jeux Olympiques. L'objectif est d'analyser les différences de performances entre les athlètes masculins et féminins dans différentes nations participantes.

-   **Graphique en barres de la répartition des médailles par genre pour chaque pays :** Un graphique en barres comparant le nombre total de médailles remportées par les athlètes masculins et féminins pour chaque pays participant. Cela permettrait de visualiser visuellement les différences de performances entre hommes et femmes dans différents pays.

-   **Graphique en secteurs ou camembert de la répartition des médailles par genre :** Un graphique en secteurs montrant la répartition des médailles entre hommes et femmes pour l'ensemble des Jeux Olympiques. Cela pourrait révéler la proportion relative de médailles remportées par chaque genre et mettre en évidence les pays où les performances des femmes sont les plus ou les moins représentées.

## 9. Comment la représentation des femmes aux Jeux Olympiques a-t-elle évolué au fil du temps ?

Cette question vise à analyser l'évolution de la représentation des femmes aux Jeux Olympiques au fil du temps. L'objectif est d'identifier les tendances et les changements dans la participation et les performances des athlètes féminines dans différents sports et pays au fil des éditions des Jeux Olympiques.

-   **Graphique en ligne de la participation des femmes au fil du temps :** Un graphique en ligne montrant la proportion de femmes parmi tous les athlètes participants aux Jeux Olympiques au fil des éditions. Cela permettrait de visualiser la tendance à l'augmentation de la participation des femmes dans le sport olympique.

-   **Graphique en barres de la répartition des médailles par genre au fil du temps :** Un graphique en barres comparant le nombre total de médailles remportées par les athlètes masculins et féminins pour chaque édition des Jeux Olympiques. Cela permettrait de visualiser visuellement les changements dans les performances des femmes par rapport aux hommes au fil du temps.

-   **Carte géographique de la participation féminine par pays :** Une carte géographique montrant la participation des athlètes féminines dans différents sports et pays au fil des éditions des Jeux Olympiques. Cela permettrait de visualiser les variations régionales dans la représentation des femmes dans le sport olympique et d'identifier les pays où des progrès significatifs ont été réalisés en matière d'inclusion des femmes dans le sport.

### Graphe analysant la répartition des médailles obtenues contre le nombre d'athlètes envoyés par pays (réalisé par : Thomas François)

```{r MedaileVsAthlete, echo=FALSE, message=FALSE, warning=FALSE}
data <- read.csv("athlete_events.csv")
noc_regions <- read.csv("noc_regions.csv")

country_summary <- data %>%
  group_by(NOC) %>%
  summarise(
    Medailles = sum(!is.na(Medal)),
    Athletes = n_distinct(Name),
  ) %>%
  filter(!is.na(NOC))

country_summary_with_regions <- left_join(country_summary, noc_regions, by = "NOC")

p <- ggplot(country_summary_with_regions, aes(x = Medailles, y = Athletes, label = region)) +
  geom_point(color = "blue", size = 3, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color="black") +
  labs(x = "Nombre de Medailles", y = "Nombre d'athlètes envoyés") +
  ggtitle("Medailles vs. Athlètes envoyés par pays")

ggplotly(p)
```

## Analyse du graphique :

Ce graphique compare le nombre d'athlètes envoyés par chaque pays et le nombre de médailles obtenues. Comme prévu, il montre que plus un pays envoie d'athlètes aux Jeux, plus il remporte de médailles, il est possible de créer une equation de la tendance : le nombre de médailles = 0.46 \* le nombre d'athlètes envoyés

Il est remarquable de constater que les pays au-dessus de la ligne de tendance sous-performent par rapport à cette moyenne, tandis que ceux en dessous sur-performent (notamment la Russie et les États-Unis).

Le graphique présente un biais significatif avec de nombreuses valeurs concentrées en bas, car la plupart des pays ont envoyé peu d'athlètes et, par conséquent, ont remporté peu de médailles. La domination des États-Unis aux Jeux olympiques, tant en nombre d'athlètes qu'en médailles, est particulièrement remarquable sur ce graphique.

### Graphe analysant le nombre d'athlète présent pour chaque édition des Jeux Olympiques (réalisé par : Thomas François)

```{r , echo=FALSE}
data <- read.csv("athlete_events.csv")
regions <- read.csv("noc_regions.csv")

# Filter data for Summer and Winter seasons
summer_data <- data %>% filter(Season == "Summer")
winter_data <- data %>% filter(Season == "Winter")

# Count unique athletes for each edition (Year) and Season
summer_athletes_count <- summer_data %>%
  group_by(Year) %>%
  summarise(nombre_athletes = n_distinct(Name))

winter_athletes_count <- winter_data %>%
  group_by(Year) %>%
  summarise(nombre_athletes = n_distinct(Name))

combined_data <- bind_rows(
  mutate(summer_athletes_count, Season = "Summer"),
  mutate(winter_athletes_count, Season = "Winter")
)

# Plotting with ggplot2
p <- ggplot(combined_data, aes(x = Year, y = nombre_athletes, color = Season)) +
  geom_line() +
  geom_point() +
  labs(x = "Année", y = "Nombre d'athlètes", color = "Session") +
  ggtitle("Nombre d'athlètes aux Jeux Olympique d'été et d'hiver") +
  theme_minimal()

ggplotly(p)
```

## Analyse du graphique

Le graphique démontre clairement que les Jeux olympiques d'été attirent un nombre plus important d'athlètes que les Jeux d'hiver. On observe également une tendance à la hausse de la participation au fil du temps, ce phénomène pouvant être expliqué par la mondialisation, la démocratisation du sport et le développement des systèmes de transport.

De plus, une observation importante est que les Jeux olympiques n'ont pas eu lieu pendant la Seconde Guerre mondiale (1939-1945).

### La baisse de participation

Il est intéressant de constater qu'il y a eu trois baisses significatives de la participation aux Jeux olympiques d'été, en 1904, 1932, 1956, et de 1976 à 1984. Pendant ces six éditions, des boycotts et divers problèmes ont empêché un certain nombre de nations de participer aux événements.

En 1904 et 1932, les Jeux olympiques ont été organisés dans des villes des États-Unis : Saint-Louis et Los Angeles. Ce choix de localisation impliquait un voyage long et difficile pour les pays participants, principalement européens à cette époque. Le manque de moyens de transport rapides et pratiques (comme les 16 jours de voyage pour l'équipe française en 1932) a entraîné une participation réduite lors de ces éditions.

En 1956, de nombreux conflits ont dissuadé les pays d'envoyer leurs équipes : l'affaire du Canal de Suez, le deuxième conflit entre l'Égypte et Israël, la violence en Afrique du Nord (notamment en Algérie), ainsi que l'invasion de la Hongrie par les chars soviétiques. De plus, le fait que la ville hôte soit Melbourne en Australie, éloignée du continent européen qui envoie le plus de participants, n'a rien arrangé.

Enfin, de 1976 à 1984, un important boycott des Jeux olympiques s'est organisé dans le contexte de la guerre froide. Le boycott des Jeux olympiques organisés en Russie ou aux États-Unis permettait de protester contre les événements qui se déroulaient à ce moment-là. La carte ci-dessous indique les nations ayant boycotté les éditions des Jeux olympiques d'été pendant cette période :

</br>

<p align="center">

<img src="https://upload.wikimedia.org/wikipedia/commons/8/84/Olympic_boycotts_1976_1980_.png" width="80%"/>

</p>

</br>

## Graphe analysant la comparaison de répartition des médailles par tranhce d'âge (réalisé par :Mohamed Amine Jabote)

```{r graphe, echo=FALSE, message=FALSE, warning=FALSE}


# Importation des données
data <- read.csv("athlete_events.csv")

# Suppression des valeurs manquantes
data <- data[complete.cases(data),]

# Création d'une variable Age_group pour regrouper les âges en tranches
data$Age_group <- cut(data$Age, breaks = c(0, 20, 30, 40, 50, 60, 70, 80, 90, 100), labels = c("0-20", "21-30", "31-40", "41-50", "51-60", "61-70", "71-80", "81-90", "91-100"))

# Réordonner les tranches d'âge
data$Age_group <- factor(data$Age_group, levels = c("0-20", "21-30", "31-40", "41-50", "51-60", "61-70", "71-80", "81-90", "91-100"))

# Calculer la largeur des barres
bar_width <- 0.8

# Création d'un graphique en barres pour la répartition des médailles par tranche d'âge
p <- ggplot(data = data, aes(x = Age_group, fill = Medal)) +
  geom_bar(position = "dodge", width = bar_width, color = "black", stat = "count") +
  labs(title = "Comparaison de la distribution des médailles olympiques par tranche d'âge",
       x = "Tranche d'âge",
       y = "Nombre de médailles") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = )) +
  scale_fill_manual(values = c("Gold" = "#FFD700", "Silver" = "#C0C0C0", "Bronze" = "#CD7F32"))

# Convertir le graphique ggplot2 en graphique interactif avec plotly
ggplotly(p)



```

```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Importation des données
data <- read_csv("athlete_events.csv")

# Suppression des valeurs manquantes


# Création d'une variable Age_group pour regrouper les âges en tranches
data <- data %>%
  mutate(Age_group = cut(Age, breaks = c(0, 20, 30, 40, 50, 60, 70, 80, 90, 100), 
                         labels = c("0-20", "21-30", "31-40", "41-50", "51-60", "61-70", "71-80", "81-90", "91-100")))

# Réordonner les tranches d'âge
data$Age_group <- factor(data$Age_group, levels = c("0-20", "21-30", "31-40", "41-50", "51-60", "61-70", "71-80", "81-90", "91-100"))

# Calculer la répartition des athlètes par tranche d'âge
age_group_counts <- data %>% count(Age_group)

# Création du graphique en barres avec Plotly
p <- plot_ly(data = age_group_counts, x = ~Age_group, y = ~n, type = 'bar',
             marker = list(color = '#69b3a2', line = list(color = 'black', width = 1))) %>%
  layout(title = "Répartition des athlètes olympiques par tranche d'âge",
         xaxis = list(title = "Tranche d'âge"),
         yaxis = list(title = "Nombre d'athlètes"),
         barmode = 'group',
         xaxis = list(tickangle = 45))

# Ajouter des étiquettes sur les barres
p <- p %>% add_annotations(x = ~Age_group, y = ~n, text = ~n, showarrow = FALSE, 
                           yshift = 10)

# Afficher le graphique
p


```

## Analyse du graphique

Dans notre analyse des données des Jeux Olympiques, nous avons scruté l'impact des caractéristiques physiques des athlètes sur leurs performances, en tenant compte du nombre d'athlètes dans chaque tranche d'âge. Nous avons observé une tendance nette dans la répartition des médailles par tranche d'âge, laquelle est significativement influencée par le nombre d'athlètes participant dans chaque groupe.

La tranche d'âge la plus fréquemment médaillée est celle des 21-30 ans, avec un total impressionnant de 21 986 médailles. Cette dominance peut être attribuée au pic de forme physique et à l'expérience compétitive que possèdent généralement les athlètes de cette catégorie. De plus, avec un nombre élevé d'athlètes (171 914), cette tranche d'âge a également une probabilité plus élevée de remporter des médailles.

Il est intéressant de noter que, indépendamment de la tranche d'âge, le nombre de médailles d'or, d'argent et de bronze est remarquablement proche. Cela suggère une performance sportive équilibrée tout au long des âges. Ainsi, quel que soit le groupe d'âge, les athlètes ont des chances similaires de remporter des médailles, bien que cela puisse être influencé par le nombre d'athlètes dans chaque catégorie.

Une augmentation notable est observée dans la catégorie des 0-20 ans, avec un total de 4 120 médailles. Cette hausse pourrait être due à une spécialisation précoce et à une meilleure formation dès le plus jeune âge, ce qui pourrait attirer un plus grand nombre d'athlètes dans cette tranche d'âge. De plus, avec 47 561 athlètes dans cette tranche d'âge, la compétition est forte, ce qui contribue à un nombre accru de médailles remportées.

En revanche, pour les athlètes âgés de 31 ans et plus, une diminution des médailles remportées est observée. Par exemple, pour la tranche 31-40 ans, 3 723 médailles ont été décernées, suivies de seulement 46 médailles pour la catégorie 41-50 ans, et 3 médailles pour la catégorie 51-60 ans. Cette baisse peut être attribuée au processus naturel de vieillissement, qui peut entraîner une diminution de la forme physique et une prédisposition accrue aux blessures. De plus, avec moins d'athlètes dans ces tranches d'âge, la concurrence est moins intense.

En analysant ces tendances, il est clair que le nombre d'athlètes dans chaque tranche d'âge influence significativement le nombre de médailles remportées. Plus le nombre d'athlètes est élevé, plus les chances de remporter des médailles dans cette tranche d'âge sont élevées. Cependant, il est important de noter que cette observation reflète une corrélation et non une causalité directe.

En conclusion, notre analyse met en lumière l'importance du nombre d'athlètes dans chaque tranche d'âge dans la détermination du nombre de médailles remportées aux Jeux Olympiques. Cette compréhension est cruciale pour les stratégies de formation et de développement des talents, ainsi que pour une meilleure appréciation des performances sportives dans différentes catégories d'âge.

```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Importation des données
data <- read_csv("athlete_events.csv")

# Filtrer les athlètes médaillés pour les trois sports
sports <- c("Swimming", "Athletics", "Judo")
medalists <- data %>%
  filter(!is.na(Medal) & Sport %in% sports) %>%
  drop_na(Height, Weight)

# Fonction pour créer un graphique pour un sport donné avec des couleurs spécifiques
create_sport_plot <- function(sport_name, point_color) {
  sport_data <- medalists %>% filter(Sport == sport_name)
  plot_ly(sport_data, x = ~Height, y = ~Weight, type = 'scatter', mode = 'markers',
          marker = list(color = point_color, opacity = 0.6)) %>%
    add_trace(x = ~Height, y = ~fitted(lm(Weight ~ Height, data = sport_data)),
              mode = 'lines', line = list(color = 'black')) %>%
    layout(title = paste("Relation entre la taille et le poids des athlètes médaillés en", sport_name),
           xaxis = list(title = "Taille (cm)"),
           yaxis = list(title = "Poids (kg)"),
           showlegend = FALSE)
}

# Créer les graphiques pour chaque sport avec les couleurs spécifiées
plot_swimming <- create_sport_plot("Swimming", "blue")
plot_athletics <- create_sport_plot("Athletics", "brown")
plot_judo <- create_sport_plot("Judo", "red")

# Afficher les graphiques
plot_swimming

```

## Graphe en nugage de points de la taille et du poids des médaillés en natation

Le graphique en nuage de points ci-dessus illustre la relation entre la taille (en centimètres) et le poids (en kilogrammes) des athlètes médaillés en natation. Chaque point bleu représente un athlète, tandis que la ligne noire correspond à la ligne de régression linéaire, indiquant la tendance générale de la relation entre ces deux variables.

L'analyse des données révèle une corrélation positive entre la taille et le poids des nageurs médaillés. Les athlètes plus grands ont tendance à être plus lourds, comme le montre la ligne de régression ascendante. Cette relation est d'autant plus forte que les points de données sont regroupés de manière dense. Cependant, il existe une certaine variation, notamment chez les nageurs très petits ou très grands, où le poids peut varier davantage.

Cette corrélation peut s'expliquer par les avantages physiques que procure une grande taille en natation, tels que des mouvements plus longs et plus puissants. Un poids proportionné à la taille contribue également à la flottabilité et à l'optimisation des performances.

Il est important de noter que la performance en natation ne dépend pas uniquement de la taille et du poids. Certains athlètes médaillés, qui s'écartent de la tendance générale en termes de caractéristiques physiques, ont réussi à exceller grâce à d'autres facteurs tels que la technique, l'entraînement et la détermination.

En conclusion, ce graphique démontre une corrélation claire entre la taille et le poids des nageurs médaillés, reflétant l'importance des caractéristiques physiques dans ce sport. Pour une analyse plus approfondie, il serait pertinent de comparer ces résultats avec d'autres disciplines sportives pour identifier des tendances similaires ou différentes.

```{r, echo=FALSE, message=FALSE, warning=FALSE}  

plot_athletics

```


## Analyse du Graphique en Nuage de Points pour les Athlètes Médaillés en Athlétisme

L'analyse des données révèle une corrélation positive entre la taille et le poids des athlètes médaillés en athlétisme. Comme dans le cas de la natation, les athlètes plus grands ont tendance à être plus lourds. Toutefois, la dispersion des points est plus marquée, ce qui reflète une plus grande variation dans les caractéristiques physiques des athlètes d'athlétisme.

Cette plus grande variation peut s'expliquer par la diversité des épreuves d'athlétisme, qui regroupent des disciplines très variées telles que les courses de vitesse, les courses de fond, les sauts et les lancers. Chaque épreuve nécessite des caractéristiques physiques spécifiques. Par exemple, les lanceurs de poids et de disque ont tendance à être plus grands et plus lourds que les sprinteurs, qui sont généralement plus petits et plus légers pour maximiser leur vitesse.

La ligne de régression montre clairement la tendance générale selon laquelle, en moyenne, les athlètes plus grands pèsent plus lourd. Cependant, la densité des points le long de cette ligne varie, indiquant que d'autres facteurs influencent également la relation entre la taille et le poids des athlètes en athlétisme.

En conclusion, bien que ce graphique démontre une corrélation entre la taille et le poids chez les athlètes médaillés en athlétisme, il met également en évidence la diversité des morphologies requises pour exceller dans les différentes disciplines. Cela souligne l'importance de considérer les spécificités de chaque épreuve pour une analyse plus fine des performances sportives. Pour une analyse plus approfondie, il serait intéressant de comparer ces résultats avec ceux d'autres disciplines sportives pour identifier des tendances similaires ou divergentes.

```{r, echo=FALSE, message=FALSE, warning=FALSE}  
plot_judo
```
## Analyse du Graphique en Nuage de Points pour les Athlètes Médaillés en Judo

L'analyse des données montre une corrélation positive significative entre la taille et le poids des judokas médaillés. En général, les athlètes plus grands tendent à peser plus lourd, comme indiqué par la pente ascendante de la ligne de régression. Cependant, il est important de noter que les points sont assez dispersés par rapport à cette ligne, indiquant une variation notable dans les caractéristiques physiques des judokas médaillés.

Cette dispersion peut être attribuée aux différentes catégories de poids présentes dans le judo, qui vont des poids légers aux poids lourds. Chaque catégorie de poids a ses propres exigences et caractéristiques physiques. Par exemple, les judokas des catégories de poids légers peuvent être plus petits et plus minces, tandis que ceux des catégories de poids lourds sont généralement plus grands et plus massifs.

La ligne de régression montre que, malgré la diversité des morphologies, il existe une tendance générale à ce que les athlètes plus grands soient également plus lourds. Cependant, cette relation est influencée par les spécificités des différentes catégories de poids, ce qui explique la plus grande dispersion des points autour de la ligne.

En conclusion, ce graphique démontre une corrélation claire entre la taille et le poids chez les judokas médaillés, mais il met également en évidence la variabilité importante des caractéristiques physiques en fonction des catégories de poids. Cette analyse souligne l'importance de considérer les catégories de poids spécifiques lors de l'évaluation des performances en judo. Pour une analyse plus approfondie, il serait intéressant de comparer ces résultats avec ceux d'autres disciplines sportives pour identifier des tendances similaires ou divergentes.

## Conslusion : 

En analysant trois types de sports qui demandent des conditions physiques différentes pour exceller, nous avons pu observer des tendances similaires en ce qui concerne la relation entre la taille et le poids des athlètes médaillés. Dans chaque discipline, les athlètes plus grands ont tendance à peser plus lourd, ce qui peut être attribué à des avantages physiques spécifiques à chaque sport.

Les caractéristiques physiques telles que la taille et le poids ont un impact significatif sur les performances et les résultats des athlètes médaillés, mais cet impact est modulé par les exigences spécifiques de chaque sport. En natation, une grande taille et un poids proportionné semblent être des atouts. En athlétisme, la diversité des épreuves permet une plus grande variabilité des caractéristiques physiques optimales. En judo, les catégories de poids dictent les morphologies des médaillés.

Pour maximiser les chances de succès, les athlètes et leurs entraîneurs doivent comprendre et optimiser les caractéristiques physiques spécifiques requises par leur discipline. De plus, la performance sportive ne repose pas uniquement sur la taille et le poids, mais également sur des facteurs tels que la technique, l'entraînement, la stratégie et la psychologie.



## Graphe analysant les pays ayant exercé une domination dans l'histoire des Jeux Olympiques (Freddy POUNA)

```{r, echo=FALSE,include=FALSE}
head(data_jo)
```

```{r, echo=FALSE, include=FALSE}
data_jo <- data_jo %>% select(-ID)
summary(data_jo)
```

```{r, echo=FALSE, include=FALSE}
duplicates <- data_jo %>% duplicated()
duplicates_table <- data_jo %>% duplicated() %>% table()
duplicates_table
```

```{r, echo=FALSE, include=FALSE}
#fin nettoyage des données
data_jo <- data_jo %>% distinct()
data_jo
```

```{r, echo=FALSE, include=FALSE}
#valeur de poids et de masse manquante
valeurs_manquantes <- data_jo %>% filter(is.na(Height) | is.na(Weight))
valeurs_manquantes
```

```{r, echo=FALSE, include=FALSE}
data_noc_regions
```

```{r, echo=FALSE, include=FALSE}
data_jo2 <- data_jo
data <- left_join(data_jo2,data_noc_regions,by = join_by(NOC))
data <- data %>% mutate(region=if_else(NOC == 'SGP','Singapore',region)) %>% select(-notes,-NOC)
```

```{r, echo=FALSE, include=FALSE}
data_pays_medailles <- data %>% filter(Medal == 'Gold' | Medal == 'Silver' | Medal == 'Bronze') %>% arrange(region,Year)
data_pays_medailles
```

```{r, echo=FALSE, include=FALSE}
data_pays_medailles <- data_pays_medailles %>% select(region,Sport,Medal,Season,Year)
classement_medailles <- data_pays_medailles %>% group_by(region) %>% summarise(total_medaille = n()) %>% arrange(desc(total_medaille))
classement_medailles
```

```{r, echo=FALSE, include=FALSE}
top10 <- classement_medailles %>% head(10)
top10
```

```{r, echo=FALSE, include=FALSE}
top10_per_medals <- data_pays_medailles %>% filter(region %in% top10$region)
top10_per_medals <- top10_per_medals %>% group_by(region,Medal) %>% summarise(total_medaille = n())
top10_per_medals
```

```{r, echo=FALSE, include=FALSE}
classement_per_medals <- data_pays_medailles %>% filter(region %in% head(classement_medailles,30)$region)
classement_per_medals <- classement_per_medals %>% group_by(region,Medal) %>% summarise(total_medaille = n())
classement_per_medals
```

```{r, echo=FALSE}
classement_per_medals <- classement_per_medals %>%
  arrange(region, desc(factor(Medal, levels = c("Bronze", "Silver", "Gold"))))
ggplot(data = classement_per_medals, aes(y = reorder(region,total_medaille), x = total_medaille, fill = factor(Medal, levels = c("Bronze", "Silver", "Gold")))) +
  geom_col() +
  labs(title = "Nombre total de médailles par pays et type de médaille",
       x = "Pays", y = "Nombre de médailles") +
  scale_fill_manual(values = c("Bronze" = "saddlebrown", "Silver" = "#C0C0C0", "Gold" = "goldenrod1")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Analyse du graphique

Dans le cadre de l'analyse des données des Jeux Olympiques, il est important de noter les pays qui ont exercé une domination remarquable tout au long de l'histoire des Jeux. En examinant les données représentées dans le graphique des médailles, nous pouvons identifier les pays qui ont historiquement été les plus dominants :

États-Unis : Les États-Unis sont souvent considérés comme l'une des nations les plus dominantes dans l'histoire des Jeux Olympiques. Avec un total impressionnant de médailles remportées à travers une multitude de sports, les États-Unis ont maintenu leur position de leader depuis de nombreuses décennies.
Russie : Bien que la Russie ait compétitionné sous différentes bannières au cours de son histoire olympique, notamment en tant que l'Union Soviétique, elle a été une force dominante dans de nombreuses éditions des Jeux. La Russie a accumulé un nombre significatif de médailles d'or, d'argent et de bronze dans divers sports.
Chine : Au cours des dernières décennies, la Chine est devenue l'une des superpuissances des Jeux Olympiques. Son investissement massif dans le sport et son système de formation d'athlètes ont porté leurs fruits, faisant de la Chine un concurrent redoutable dans presque toutes les disciplines.
Allemagne : Que ce soit en tant que l'Allemagne unifiée ou l'Allemagne de l'Est et de l'Ouest séparées, ce pays a maintenu une présence solide sur le podium olympique. L'Allemagne a été particulièrement forte dans les sports d'hiver ainsi que dans plusieurs sports d'été.
Royaume-Uni : Le Royaume-Uni a une longue histoire aux Jeux Olympiques et a été un compétiteur remarquable dans plusieurs sports. Avec des performances impressionnantes dans des sports comme la voile, l'athlétisme et le cyclisme, le Royaume-Uni a constamment remporté des médailles tout au long de son histoire olympique.
En conclusion, ces pays, parmi d'autres, ont démontré une domination remarquable dans l'histoire des Jeux Olympiques, témoignant de leur engagement envers l'excellence sportive et de leur capacité à former et à soutenir des athlètes de classe mondiale. Quels sont donc les facteur ayant concourru à l'égémonie de leurs athlètes au cours de l'histoire des jeux. 

## Question 9 :
## Analyse d'évolution des représentation des femmes aux jeux olympiques

```{r, echo=FALSE}

total_femmes <- data_jo %>%
  filter(Sex == "F") %>%
  group_by(Games) %>%
  summarise(Nombre_femmes = n())

# Calculer la proportion de femmes parmi les athlètes pour chaque édition des Jeux Olympiques
proportion_femmes <- data_jo %>%
  group_by(Games) %>%
  summarise(Proportion_femmes = mean(Sex == "F", na.rm = TRUE))

# Fusionner les données de nombre total de femmes et de proportion de femmes
data_femmes <- left_join(total_femmes, proportion_femmes, by = "Games")

# Créer un graphique en ligne interactif avec Plotly pour visualiser les proportions au fil du temps
plot_ly(data_femmes, x = ~Games, y = ~Proportion_femmes, type = 'scatter', mode = 'lines', line = list(color = 'blue')) %>%
  add_trace(y = ~Nombre_femmes, name = "Nombre de femmes", yaxis = "y2", type = 'scatter', mode = 'lines', line = list(color = 'red')) %>%
  layout(title = "Participation des femmes aux Jeux Olympiques au fil du temps",
         xaxis = list(title = "Édition des Jeux Olympiques"),
         yaxis = list(title = "Proportion de femmes parmi les athlètes", side = "left"),
         yaxis2 = list(title = "Nombre de femmes", side = "right", overlaying = "y", showgrid = FALSE),
         hovermode = "closest",
         showlegend = TRUE,
         legend = list(orientation = "h"))

```


Le graphique ci-dessus illustre l'évolution de la participation des femmes aux Jeux Olympiques au fil du temps, en mettant en évidence la proportion de femmes parmi les athlètes et le nombre total de femmes participant à chaque édition des Jeux.

Proportion de femmes :



## Question 5 : 

## Analyse de l'impact du niveau économique d'un pays sur ses performances aux Jeux Olympiques

```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Charger les données
data_jo <- read_csv('athlete_events.csv')
data_noc_regions <- read_csv('noc_regions.csv')
data_PIB <- read_delim('GDP_per_capita.csv', delim = ';')

# Renommer la première colonne de data_PIB en "Country" pour la jointure
names(data_PIB)[1] <- "Country"

# Préparer les données des Jeux Olympiques
data_jo <- data_jo %>%
  filter(!is.na(Medal)) %>%
  group_by(NOC, Year) %>%
  summarise(total_medals = n()) %>%
  ungroup()

# Préparer les données de PIB par habitant
data_PIB_long <- data_PIB %>%
  pivot_longer(cols = starts_with('19') | starts_with('20') | starts_with('21'), names_to = "Year", values_to = "GDP_per_capita") %>%
  mutate(Year = as.numeric(Year)) %>%
  mutate(GDP_per_capita = as.numeric(GDP_per_capita))  # Assurez-vous que les valeurs de GDP_per_capita sont numériques

# Fusionner les données des JO avec les régions NOC
data_jo <- data_jo %>%
  left_join(data_noc_regions, by = "NOC")

# Fusionner les données des médailles avec les données de PIB par habitant
data_combined <- data_jo %>%
  left_join(data_PIB_long, by = c("region" = "Country", "Year"))

# Filtrer les données complètes
data_combined <- data_combined %>%
  filter(!is.na(GDP_per_capita))

# Créer des tranches de PIB par habitant en utilisant des quantiles
data_combined <- data_combined %>%
  mutate(GDP_bin = cut(GDP_per_capita, breaks = quantile(GDP_per_capita, probs = seq(0, 1, by = 0.1), na.rm = TRUE), include.lowest = TRUE))

# Créer un box plot avec Plotly
p <- plot_ly(data_combined, y = ~total_medals, x = ~GDP_bin, type = 'box', boxpoints = 'all',
             jitter = 0.3, pointpos = -1.8, marker = list(color = 'rgba(152, 0, 0, .8)'),
             text = ~paste('Country:', region, '<br>Year:', Year)) %>%
  layout(title = "Distribution des médailles par tranches de PIB par habitant",
         xaxis = list(title = "Tranches de PIB par habitant (USD)", categoryorder = "array",
                      categoryarray = unique(data_combined$GDP_bin)),
         yaxis = list(title = "Nombre total de médailles"))

# Afficher le graphique
p

```
Le graphique met en lumière la répartition des médailles obtenues aux Jeux Olympiques selon les tranches de PIB par habitant, organisées en déciles. Plusieurs observations et analyses peuvent être tirées de ces données.

Disparité des Médailles :
Les tranches de PIB les plus élevées, telles que celles situées entre 777 et 896 USD, et entre 896 et 1401 USD, affichent généralement un nombre plus important de médailles par rapport aux tranches de PIB plus faibles. Par exemple, les pays ayant un PIB par habitant compris entre 777 et 896 USD présentent une diversité plus large de médailles, avec certains pays accumulant plus de 80 médailles.

Médianes et Quartiles :
Les médianes, représentées par les lignes centrales des boîtes (boxplots), demeurent relativement basses pour toutes les tranches, suggérant que la majorité des pays remportent un nombre modeste de médailles. Les quartiles inférieurs et supérieurs révèlent également que même dans les tranches de PIB les plus élevées, une grande majorité des pays obtiennent un nombre relativement faible de médailles.

Outliers :
Des points de données sont dispersés au-dessus des boîtes (outliers), notamment dans les tranches de PIB les plus élevées. Ces outliers représentent des pays ayant connu un succès exceptionnel aux Jeux Olympiques malgré un PIB par habitant potentiellement modeste. Les tranches de PIB plus élevées affichent généralement davantage d'outliers, suggérant ainsi une corrélation entre un PIB plus élevé et un succès olympique accru.

Interprétation des Tranches de PIB :
La distribution suggère une corrélation positive entre un PIB par habitant plus élevé et un succès olympique accru, bien que cette relation ne soit pas linéaire et qu'il existe de nombreuses variations au sein de chaque tranche. Certaines tranches de PIB intermédiaires, telles que celles situées entre 576 et 696 USD, présentent également une dispersion relativement élevée des médailles, indiquant que le PIB n'est pas le seul facteur déterminant le succès olympique.

En conclusion, l'analyse de la distribution des médailles par tranches de PIB par habitant met en lumière la complexité des facteurs qui influencent les performances des pays aux Jeux Olympiques. Alors que le PIB par habitant peut jouer un rôle significatif dans le succès olympique, d'autres facteurs tels que l'investissement dans le sport, les infrastructures, la culture sportive et les politiques sportives nationales peuvent également contribuer de manière significative aux performances des pays aux Jeux Olympiques. Cette analyse souligne l'importance de considérer une gamme de facteurs pour comprendre pleinement les dynamiques complexes qui sous-tendent les performances sportives à l'échelle mondiale.


