---
title: "Rapport IF36 - 120 years of olympic history"
subtitle: "Semestre : P24"
author: "Mohamed Amine jabote / Thomas Francois / Freddy Durel Pouna Wantou"
date: "2024-04-25"
output: 
  html_document:
    runtime: shiny
    viewport: width=device-width, initial-scale=1
---

```{r setup, include=FALSE}

library(dplyr)
library(ggplot2)
library(readr)
library(plotly)
library(tidyr)

```

```{r loading data, include=FALSE}
data_jo = read_csv('athlete_events.csv')
data_noc_regions <- read_csv('noc_regions.csv')
```


</br>
<p align="center">
	<img src="https://st.depositphotos.com/2793427/4712/i/450/depositphotos_47122635-stock-photo-white-olympics-flag-against-the.jpg" width="80%" />	
</p>
</br>


# Introduction

Le jeu de données __"120 ans de l'histoire des Jeux Olympiques"__ contient les données de 28 éditions d'été et 22 d'hiver des Jeux Olympiques, ce qui équivaut à un peu moins de 136 000 individus, répartis sur 15 variables. Ces variables comprennent des informations telles que le nom de l'athlète, son âge, son poids, sa taille, son sexe, la saison des Jeux Olympiques, les médailles remportées, etc. Les données proviennent du site www.sports-reference.com et elles sont le résultat d'un travail de recherche réalisé par un groupe intéressé par l'histoire des jeux olympiques. Le site propose une base de données complète avec des informations diverses et variées sur les médailles gagnées par chaque pays, les résultats des compétitions, et bien plus encore.

Nous avons sélectionné un ensemble de données sur les Jeux olympiques en raison de l'engouement actuel en France pour cet événement, en particulier avec les Jeux olympiques de **Paris 2024** à l'horizon. Les Jeux olympiques représentent une célébration mondiale de l'excellence sportive et de la diversité culturelle, et ils captivent l'attention de millions de personnes à travers le monde. Avec des membres de notre groupe ayant des niveaux de connaissances variés sur les Jeux olympiques, l'étude de ce dataset nous offre l'opportunité unique de plonger dans l'histoire et les tendances de cet événement emblématique, tout en élargissant notre compréhension de l'impact du sport sur la société à travers les âges.

Le jeu de données est disponible sur [Cette page Kaggle](https://www.kaggle.com/datasets/heesoo37/120-years-of-olympic-history-athletes-and-results?select=athlete_events.csv) et a été publié par [**Randi H Griffin**](https://www.linkedin.com/in/randigriffin/), une Lead Data Scientist chez __BCG__, dans le but de découvrir l'évolution des Jeux Olympiques ainsi que la participation et les performances des athlètes et des pays. Les données sont fournies au format __CSV__.

</br>

## Données

Le tableau ci-dessous présente les **15 attributs** du jeu de données sur lequel nous allons travailler. Ces données sont extraites d'un ensemble de données concernant les performances des athlètes aux Jeux olympiques.

Chaque attribut offre des informations précieuses sur les athlètes, les événements sportifs et les médailles remportées. Ces données sont pertinentes pour notre projet car elles nous permettront d'analyser les performances des athlètes dans différents sports et événements, d'étudier les tendances au fil des éditions des Jeux olympiques et d'identifier les caractéristiques des médaillés olympiques.

Certaines variables, telles que **le sexe de l'athlète**,**la saison des Jeux olympiques (été ou hiver)** et **la nationalité de l'équipe de l'athlète**, présentent des catégories ou des sous-groupes au sein des données, ce qui nous permettra d'effectuer des analyses plus détaillées en fonction de ces caractéristiques.

Le tableau ci-dessous offre une description détaillée de chaque attribut, y compris son nom, sa signification et son type de données. Ces informations serviront de référence tout au long de notre projet.

<br>
<div width="100%" align="center">

| Attribut   | Description                  | Type     | Format | Catégorie |
|------------|------------------------------|----------|-----------|-----------|
| **ID**         | Identifiant unique de l'athlète        | Texte | String | Nominal |
| **Name**       | Nom de l'athlète                | Texte    | String | Nominal |
| **Sexe**       | Sexe de l'athlète ***(homme ou femme)***            | Texte    | String | Nominal |
| **Age**        | Âge de l'athlète lors des Jeux olympiques              | Numérique| Integer | Continu|
| **Height**     | Taille de l'athlète en centimètres          | Numérique| Integer | Continu |
| **Weight**     | Poids de l'athlète en kilogrammes           | Numérique| Float | Continu |
| **Team**       | Nationalité de l'équipe de l'athlète           | Texte    | String | String | Nominal|
| **NOC**        | Abréviation du Comité national olympique de l'équipe          | Texte    | String | Nominal|
| **Games**      | Nom de l'édition des Jeux olympiques          | Texte    |  String | Nominal|
| **Year**       | Année de l'édition des Jeux olympiques        | Texte    | YYYY | Discret |
| **Season**     | Saison des Jeux olympiques ***(été ou hiver)***     | Texte    | String| Ordinal |
| **City**       | Ville hôte des Jeux olympiques        | Texte    | String | Nominal |
| **Sport**      | Sport pratiqué par l'athlète          | Texte    | String | Nominal |
| **Event**      | Événement sportif dans lequel l'athlète a participé   | Texte    | String | Nominal |
| **Medal**      | Type de médaille remportée par l'athlète ***(or, argent, bronze ou aucune)*** | Texte    | String | Ordinal|
</div>
</br>

## Plan d'analyse
Nous avons compilé une série de questions que nous tenterons de résoudre en utilisant le jeu de données. Pour chaques question, nous avons une liste d'examples de visualisations possibles. Ces questions sont divisées en deux catégories principales : l'évolution des Jeux Olympiques et les performances des athlètes. 

#### L'évolution des Jeux Olympiques
## 1. Quels pays ont exercé une domination dans l'histoire des Jeux Olympiques ? 
  Dans cette analyse, nous chercherons à identifier les pays qui ont accumulé le plus grand nombre de médailles dans l'histoire des Jeux Olympiques, qu'elles soient en or, argent ou bronze, ainsi que le total de ces médailles. De plus, nous déterminerons pour chaque discipline quel pays a remporté le plus de médailles.

- **Graphique à barres des meilleurs pays par médailles :** 
  Pour comparer directement les performances des pays les plus réussis. Il permet une comparaison claire et rapide des totaux de médailles entre les principaux pays, ce qui est utile pour identifier les leaders incontestés et les écarts significatifs entre eux.
  
- **Diagramme circulaire ou camembert des médailles par type :** 
  Pour illustrer la répartition des médailles par type pour chaque pays. Il offre une vue d'ensemble instantanée des performances relatives en or, argent et bronze, permettant de déterminer si un pays a une domination particulière dans une catégorie de médailles.
  
- **Courbe présentant l'évolution du nombre total de médailles sur les 150 dernières années pour les pays dominants :** 
permet d'identifier les périodes de domination ou de déclin, ainsi que les évolutions à long terme des performances olympiques des pays.
    
## 2. Comment les Jeux Olympiques d'été se différencient-ils aux Jeux Olympiques d'hiver ?

Cette question examine comment les Jeux Olympiques d'été se différencient des Jeux Olympiques d'hiver en termes de sports pratiqués, de nombre d'épreuves, de participants, et d'autres aspects. Elle met en évidence les distinctions entre les deux versions du même événement.

- **Graphique en barres du nombre d'épreuves :** 
  Graphique en barres comparant le nombre total d'épreuves aux Jeux Olympiques d'été et d'hiver au fil du temps. Cela permet de visualiser les variations dans la taille et la complexité des deux événements au fil des ans.
  
- **Diagramme circulaire des participants :** 
  Un diagramme circulaire montrant la répartition des participants par région ou pays aux Jeux Olympiques d'été et d'hiver. Cela permet de comparer la diversité géographique des participants entre les deux événements.
  
- **Graphique en barres empilées des médailles par pays :** 
  Un graphique en barres empilées comparant les médailles remportées par chaque pays aux Jeux Olympiques d'été et d'hiver. Cette visualisation met en évidence les performances des pays dans les deux types de jeux et permet de déterminer s'il existe des différences significatives dans les pays dominant chaque événement.

## 3. Comment varie le nombre d'épreuves sportives et le nombre d'athlètes participant aux Jeux Olympiques au fil du temps ?

L'objectif ici est de déterminer quels sont les sports qui ont été intégrés au cours des années et à quel moment ceux-ci se sont intégrés. Ceci aussi a pour visée de déterminer la raison de l'ajout de ces disciplines (popularité grandissante ou juste nouveau sport). Dans un second temps, il s'agira d'identifier ou non l'entrée en liste de nouveaux pays participants dans les jeux. D'en déterminer les origines (première qualification ou alors accueil de nouveaux pays admissibles). Enfin, il s'agit de déterminer comment évolue le nombre d'athlètes participant aux jeux au fil des années.

- **Graphique en ligne du nombre d'athlètes par année :**
  Un graphique en ligne représentant l'évolution du nombre total d'athlètes participant aux Jeux Olympiques au fil des ans. Cette visualisation mettrait en évidence les variations dans la taille de la délégation olympique mondiale au fil du temps.
  
- **Graphique en barres du nombre d'épreuves par discipline sportive :**
  Un graphique en barres montrant le nombre d'épreuves par discipline sportive (par exemple, course, lancer, saut pour l'athlétisme) aux Jeux Olympiques au fil du temps. Cela offre une vue détaillée des changements dans la composition et la diversité des épreuves sportives au fil des ans.

## 4. Est-ce que le pays hôte des Jeux Olympiques bénéficie d'un avantage par rapport aux autres nations participantes ?

Cette question vise à déterminer si le pays hôte des Jeux Olympiques bénéficie d'un avantage en termes de participation et de performances sportives, telles que le nombre de médailles accumulées, par rapport aux autres nations participantes. L'objectif est d'analyser si le fait d'accueillir les Jeux Olympiques donne un élan supplémentaire aux athlètes du pays hôte, leur permettant de performer au-dessus de la moyenne par rapport à leurs performances habituelles.

- **Graphique en barres du nombre de médailles par pays :** 
  Un graphique en barres comparant le nombre total de médailles remportées par le pays hôte par rapport aux autres nations participantes. Cela permettrait de voir visuellement si le pays hôte obtient plus de médailles que la moyenne des autres pays.
  
- **Graphique en barres empilées des médailles par type pour le pays hôte et les autres nations :** 
  Un graphique en barres empilées montrant la répartition des médailles d'or, d'argent et de bronze remportées par le pays hôte et les autres nations participantes. Cette visualisation permettrait de comparer les performances dans chaque catégorie de médailles.
  
- **Nuage de points des performances par rapport à la moyenne :**
  Un nuage de points avec le pays hôte et les autres nations sur l'axe des x et le nombre total de médailles sur l'axe des y. Chaque point représenterait une édition des Jeux Olympiques, et sa position par rapport à une ligne moyenne permettrait de visualiser si le pays hôte surperforme ou sous-performe par rapport à la moyenne des autres nations.

## 5. Existe-t-il une relation entre le niveau économique d'un pays et ses performances aux Jeux Olympiques ?

Il est intéressant d'explorer si le niveau économique d'un pays, mesuré par le PIB par habitant, influence ses performances aux Jeux Olympiques. Cette analyse nous aide à voir comment l'argent et les ressources affectent les succès sportifs à travers les nations.

- **Nuage de points du PIB par habitant par rapport au nombre de médailles :** 
  Un nuage de points avec le PIB par habitant sur l'axe des x et le nombre total de médailles remportées sur l'axe des y pour chaque pays participant aux Jeux Olympiques. Chaque point représente un pays pour une année donnée, permettant de visualiser s'il existe une corrélation entre la richesse économique d'un pays et son succès aux Jeux Olympiques.
  
- **Graphique en ligne de l'évolution du PIB par habitant et du nombre de médailles :** 
  Un graphique en ligne avec le PIB par habitant et le nombre total de médailles remportées pour chaque année olympique. Cette visualisation permettrait d'observer comment l'évolution du niveau économique d'un pays au fil du temps est liée à ses performances aux Jeux Olympiques.

### Les athlètes

## 6. Quels sont les athlètes qui ont marqué les jeux olympiques ?

  Cette question cherche à identifier les athlètes qui ont marqué les Jeux Olympiques par leurs performances exceptionnelles. L'objectif est d'analyser les données historiques des Jeux Olympiques pour identifier les athlètes les plus médaillés, les records établis et les moments marquants de l'histoire des Jeux.
  
- **Graphique en barres des athlètes les plus médaillés :** n graphique en barres montrant les athlètes ayant remporté le plus grand nombre de médailles olympiques, classés par discipline sportive ou nombre total de médailles. Cette visualisation permettrait d'identifier les athlètes les plus titrés de l'histoire des Jeux Olympiques.

- **Graphique en nuage de points des records battus au fil du temps :** 
	 Un graphique en nuage de points représentant les records olympiques battus au fil des éditions des Jeux Olympiques. Chaque point représenterait un record battu dans une discipline sportive spécifique, avec l'année sur l'axe des x et la performance réalisée sur l'axe des y. Cette visualisation permettrait de visualiser les tendances et les progrès réalisés dans différentes disciplines au fil du temps.
    
## 7. Quels sont les impacts des caractéristiques physiques sur les résultats ?

  Cette question vise à explorer les impacts des caractéristiques physiques des athlètes sur leurs performances aux Jeux Olympiques. L'objectif est d'analyser comment des facteurs tels que la taille, le poids, l'âge et d'autres caractéristiques physiques peuvent influencer les résultats sportifs.
  
- **Graphique en nuage de points de la taille et du poids des médaillés :**
	 Un graphique en nuage de points représentant la relation entre la taille et le poids des athlètes médaillés dans différentes disciplines sportives. Cela permettrait d'identifier s'il existe des tendances générales entre les caractéristiques physiques des athlètes et leurs performances.
	 
- **Graphique en barres des médailles par tranche d'âge :** 
	 Un graphique en barres montrant la répartition des médailles par tranche d'âge des athlètes. Cela permettrait d'analyser si les performances sportives varient en fonction de l'âge des athlètes et s'il existe des différences significatives entre les groupes d'âge.
	 
- **Analyse de corrélation entre les caractéristiques physiques et les performances (Nuage) :** 
	 Une analyse statistique explorant les corrélations entre les caractéristiques physiques telles que la taille, le poids, l'âge, etc., et les performances sportives des athlètes. Cette analyse pourrait mettre en évidence les facteurs physiques qui ont le plus d'impact sur les résultats sportifs aux Jeux Olympiques.
    
## 8. Est-ce que la répartition des médailles entre hommes et femmes varie selon les pays ?

  Cette question vise à examiner si la répartition des médailles entre hommes et femmes varie d'un pays à l'autre aux Jeux Olympiques. L'objectif est d'analyser les différences de performances entre les athlètes masculins et féminins dans différentes nations participantes.
  
- **Graphique en barres de la répartition des médailles par genre pour chaque pays :** 
	 Un graphique en barres comparant le nombre total de médailles remportées par les athlètes masculins et féminins pour chaque pays participant. Cela permettrait de visualiser visuellement les différences de performances entre hommes et femmes dans différents pays.
	 
- **Graphique en secteurs ou camembert de la répartition des médailles par genre :**
	 Un graphique en secteurs montrant la répartition des médailles entre hommes et femmes pour l'ensemble des Jeux Olympiques. Cela pourrait révéler la proportion relative de médailles remportées par chaque genre et mettre en évidence les pays où les performances des femmes sont les plus ou les moins représentées.
    
## 9. Comment la représentation des femmes aux Jeux Olympiques a-t-elle évolué au fil du temps ?

  Cette question vise à analyser l'évolution de la représentation des femmes aux Jeux Olympiques au fil du temps. L'objectif est d'identifier les tendances et les changements dans la participation et les performances des athlètes féminines dans différents sports et pays au fil des éditions des Jeux Olympiques.
  
- **Graphique en ligne de la participation des femmes au fil du temps :** 
	Un graphique en ligne montrant la proportion de femmes parmi tous les athlètes participants aux Jeux Olympiques au fil des éditions. Cela permettrait de visualiser la tendance à l'augmentation de la participation des femmes dans le sport olympique.
	
- **Graphique en barres de la répartition des médailles par genre au fil du temps :** 
	Un graphique en barres comparant le nombre total de médailles remportées par les athlètes masculins et féminins pour chaque édition des Jeux Olympiques. Cela permettrait de visualiser visuellement les changements dans les performances des femmes par rapport aux hommes au fil du temps.
	
- **Carte géographique de la participation féminine par pays :** 
	Une carte géographique montrant la participation des athlètes féminines dans différents sports et pays au fil des éditions des Jeux Olympiques. Cela permettrait de visualiser les variations régionales dans la représentation des femmes dans le sport olympique et d'identifier les pays où des progrès significatifs ont été réalisés en matière d'inclusion des femmes dans le sport.
	
### Graphe analysant la répartition des médailles obtenues contre le nombre d'athlètes envoyés par pays (réalisé par : Thomas François)
```{r MedaileVsAthlete, echo=FALSE, message=FALSE, warning=FALSE}
data <- read.csv("athlete_events.csv")
noc_regions <- read.csv("noc_regions.csv")

country_summary <- data %>%
  group_by(NOC) %>%
  summarise(
    Medals = sum(!is.na(Medal)),
    Athletes = n_distinct(Name),
  ) %>%
  filter(!is.na(NOC))

country_summary_with_regions <- left_join(country_summary, noc_regions, by = "NOC")


p <- ggplot(country_summary_with_regions, aes(x = Medals, y = Athletes, label = region)) +
  scale_x_log10() +  # Use log scale for x-axis
  scale_y_log10() +
  geom_point(color = "blue", size = 3, alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color="black") +
  labs(x = "Number of Medals", y = "Number of Athletes Sent") +
  ggtitle("Medals vs. Athletes Sent by Country")

ggplotly(p)
```


### Graphe analysant le nombre d'athlète présent pour chaque édition des Jeux Olympiques (réalisé par : Thomas François)
```{r , echo=FALSE}
data <- read.csv("athlete_events.csv")
regions <- read.csv("noc_regions.csv")

# Filter data for Summer and Winter seasons
summer_data <- data %>% filter(Season == "Summer")
winter_data <- data %>% filter(Season == "Winter")

# Count unique athletes for each edition (Year) and Season
summer_athletes_count <- summer_data %>%
  group_by(Year) %>%
  summarise(num_unique_athletes = n_distinct(Name))

winter_athletes_count <- winter_data %>%
  group_by(Year) %>%
  summarise(num_unique_athletes = n_distinct(Name))

combined_data <- bind_rows(
  mutate(summer_athletes_count, Season = "Summer"),
  mutate(winter_athletes_count, Season = "Winter")
)

# Plotting with ggplot2
p <- ggplot(combined_data, aes(x = Year, y = num_unique_athletes, color = Season)) +
  geom_line() +
  geom_point() +
  labs(x = "Year", y = "Number of Unique Athletes", color = "Season") +
  ggtitle("Number of Unique Athletes Sent in Summer and Winter Olympics") +
  theme_minimal()

ggplotly(p)
```
	
	
	
## Graphe analysant la comparaison de répartition des médailles par tranhce d'âge (réalisé par :Mohamed Amine Jabote)
```{r graphe, echo=FALSE, message=FALSE, warning=FALSE}


# Importation des données
data <- read.csv("athlete_events.csv")

# Suppression des valeurs manquantes
data <- data[complete.cases(data),]

# Création d'une variable Age_group pour regrouper les âges en tranches
data$Age_group <- cut(data$Age, breaks = c(0, 20, 30, 40, 50, 60, 70, 80, 90, 100), labels = c("0-20", "21-30", "31-40", "41-50", "51-60", "61-70", "71-80", "81-90", "91-100"))

# Réordonner les tranches d'âge
data$Age_group <- factor(data$Age_group, levels = c("0-20", "21-30", "31-40", "41-50", "51-60", "61-70", "71-80", "81-90", "91-100"))

# Calculer la largeur des barres
bar_width <- 0.8

# Création d'un graphique en barres pour la répartition des médailles par tranche d'âge
p <- ggplot(data = data, aes(x = Age_group, fill = Medal)) +
  geom_bar(position = "dodge", width = bar_width, color = "black", stat = "count") +
  labs(title = "Comparaison de la distribution des médailles olympiques par tranche d'âge",
       x = "Tranche d'âge",
       y = "Nombre de médailles") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = )) +
  scale_fill_manual(values = c("Gold" = "#FFD700", "Silver" = "#C0C0C0", "Bronze" = "#CD7F32"))

# Convertir le graphique ggplot2 en graphique interactif avec plotly
ggplotly(p)



```


## Analyse du Graphique : Comparaison de la distribution des médailles olympiques par tranche d'âge

En analysant les données des Jeux Olympiques, nous avons cherché à comprendre l'impact des caractéristiques physiques des athlètes sur leurs performances Pour répondre à la question 7. Une tendance nette émerge quant à la répartition des médailles selon les tranches d'âge.La tranche d'âge la plus fréquemment médaillée est celle des 21-30 ans, représentant un total impressionnant de **21,986 médailles**. Cette prédominance s'explique par le pic de forme physique et l'expérience compétitive que les athlètes de cette catégorie possèdent. Indépendamment de la tranche d'âge, le nombre de médailles d'or, d'argent et de bronze est remarquablement proche. Cela témoigne d'une performance sportive équilibrée tout au long des âges.La catégorie des 0-20 ans montre une augmentation notable avec **4,120 médailles**. Cette hausse pourrait s'expliquer par une spécialisation plus précoce et une meilleure formation dès le plus jeune âge.Les athlètes âgés de 31 ans et plus connaissent une diminution des médailles remportées. Pour la tranche 31-40 ans, **3,723 médailles** ont été décernées, suivies de **46 médailles** pour la catégorie 41-50 ans et seulement **3 médailles** pour la catégorie 51-60 ans. Cette tendance pourrait être attribuée au déclin physique naturel et à une prédisposition accrue aux blessures. Cependant, il est important de noter que certains athlètes de ces tranches d'âge restent compétitifs et excèlent dans des sports qui ne requièrent pas une grande force physique ou endurance.

## Graphe de Freddy ...

```{r, echo=FALSE,include=FALSE}
head(data_jo)
```
```{r, echo=FALSE, include=FALSE}
data_jo <- data_jo %>% select(-ID)
summary(data_jo)
```
```{r, echo=FALSE, include=FALSE}
duplicates <- data_jo %>% duplicated()
duplicates_table <- data_jo %>% duplicated() %>% table()
duplicates_table
```
```{r, echo=FALSE, include=FALSE}
#fin nettoyage des données
data_jo <- data_jo %>% distinct()
data_jo
```
```{r, echo=FALSE, include=FALSE}
#valeur de poids et de masse manquante
valeurs_manquantes <- data_jo %>% filter(is.na(Height) | is.na(Weight))
valeurs_manquantes
```
```{r, echo=FALSE, include=FALSE}
data_noc_regions
```

```{r, echo=FALSE, include=FALSE}
data_jo2 <- data_jo
data <- left_join(data_jo2,data_noc_regions,by = join_by(NOC))
data <- data %>% mutate(region=if_else(NOC == 'SGP','Singapore',region)) %>% select(-notes,-NOC)
```


```{r, echo=FALSE, include=FALSE}
data_pays_medailles <- data %>% filter(Medal == 'Gold' | Medal == 'Silver' | Medal == 'Bronze') %>% arrange(region,Year)
data_pays_medailles
```
```{r, echo=FALSE, include=FALSE}
data_pays_medailles <- data_pays_medailles %>% select(region,Sport,Medal,Season,Year)
classement_medailles <- data_pays_medailles %>% group_by(region) %>% summarise(total_medaille = n()) %>% arrange(desc(total_medaille))
classement_medailles
```

```{r, echo=FALSE, include=FALSE}
top10 <- classement_medailles %>% head(10)
top10
```

```{r, echo=FALSE}
# Création du graphique avec les couleurs de drapeaux
ggplot(data = top10, aes(x = reorder(region,total_medaille), y = total_medaille)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r, echo=FALSE, include=FALSE}
top10_per_medals <- data_pays_medailles %>% filter(region %in% top10$region)
top10_per_medals <- top10_per_medals %>% group_by(region,Medal) %>% summarise(total_medaille = n())
top10_per_medals
```

```{r, echo=FALSE, include=FALSE}
ggplot(data = top10_per_medals, aes(x = reorder(region,total_medaille), y = total_medaille, fill = Medal)) +
  geom_col(position = "dodge") +
  labs(title = "Nombre total de médailles par pays et type de médaille",
       x = "Pays", y = "Nombre de médailles") +
  scale_fill_manual(values = c("Gold" = "goldenrod1", "Silver" = "#C0C0C0", "Bronze" = "saddlebrown")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```

```{r, echo=FALSE}
ggplot(head(classement_medailles,30),aes(y =reorder(region,total_medaille),x=total_medaille))+
  geom_col() +
  labs(title = "classement des pays les plus médaillés des jeux olympiques", x="total de médailles", y="pays")
```
```{r, echo=FALSE, include=FALSE}
classement_per_medals <- data_pays_medailles %>% filter(region %in% head(classement_medailles,30)$region)
classement_per_medals <- classement_per_medals %>% group_by(region,Medal) %>% summarise(total_medaille = n())
classement_per_medals
```

```{r, echo=FALSE}
classement_per_medals <- classement_per_medals %>%
  arrange(region, desc(factor(Medal, levels = c("Bronze", "Silver", "Gold"))))
ggplot(data = classement_per_medals, aes(y = reorder(region,total_medaille), x = total_medaille, fill = Medal)) +
  geom_col() +
  labs(title = "Nombre total de médailles par pays et type de médaille",
       x = "Pays", y = "Nombre de médailles") +
  scale_fill_manual(values = c("Gold" = "goldenrod1", "Silver" = "#C0C0C0", "Bronze" = "saddlebrown")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```
